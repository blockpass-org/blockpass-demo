"use strict";class BlockpassKYCConnect{constructor(e,t={env:"prod",local_user_id:""}){this.client_id=e,this.env=t.env,this.local_user_id=t.local_user_id,this.baseUrl="http://localhost:8000",this.source=this.baseUrl+"/widget.html?clientId="+this.client_id+"&env="+this.env+"&refId="+this.local_user_id,this.iframe=document.createElement("iframe"),this.button=document.getElementById("blockpass-kyc-connect"),this.html=document.getElementsByTagName("html")[0],this.body=document.getElementsByTagName("body")[0],this.callbackKYCConnectSuccess=null,this.callbackKYCConnectCancel=null,this.callbackKYCConnectClose=null}startKYCConnect(){const e=this;document.getElementById("blockpass-kyc-connect").addEventListener("click",function(t){e.appendIframe()}),e.getEvents()}appendIframe(){this.html.style.overflow="hidden",this.body.style.margin="0",this.iframe.setAttribute("src",this.source),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("frameborder","none"),this.iframe.setAttribute("border","0"),this.iframe.setAttribute("resize","none"),this.iframe.setAttribute("id","blockpass-iframe"),this.iframe.setAttribute("style","z-index: 99999999999;  width: 100%; height: 100%; overflow: hidden auto; visibility: visible; margin: 0px; padding: 0px; position: fixed; border-color: transparent; border-width: 0; border-style: none; left: 0px; top: 0px; -webkit-tap-highlight-color: transparent;"),document.body.appendChild(this.iframe)}getEvents(){const e=this;window.addEventListener("message",function(t){t.origin==e.baseUrl&&("KYCConnectSuccess"===t.data&&(setTimeout(function(){e.stopKYCConnect(),"function"==typeof e.callbackKYCConnectClose&&e.callbackKYCConnectClose()},1e4),"function"==typeof e.callbackKYCConnectSuccess&&e.callbackKYCConnectSuccess()),"KYCConnectCancel"===t.data&&(e.stopKYCConnect(),"function"==typeof e.callbackKYCConnectCancel&&e.callbackKYCConnectCancel()),"KYCConnectClose"===t.data&&(e.stopKYCConnect(),"function"==typeof e.callbackKYCConnectClose&&e.callbackKYCConnectClose()))}),document.onkeydown=function(t){("key"in(t=t||window.event)?"Escape"===t.key||"Esc"===t.key:27===t.keyCode)&&(e.stopKYCConnect(),window.postMessage("KYCConnectCancel","*"))}}on(e,t){"KYCConnectSuccess"===e&&(this.callbackKYCConnectSuccess=t),"KYCConnectCancel"===e&&(this.callbackKYCConnectCancel=t),"KYCConnectClose"===e&&(this.callbackKYCConnectClose=t)}stopKYCConnect(){this.html.style.removeProperty("overflow"),this.body.style.removeProperty("overflow"),this.html.style.removeProperty("margin"),this.body.style.removeProperty("margin"),this.iframe.setAttribute("style","display:none"),this.iframe.setAttribute("src","#"),document.body.appendChild(this.iframe)}}