"use strict";class BlockpassKYCConnect{constructor(e,t={env:"prod",local_user_id:"",baseUrlWidget:"https://demo.blockpass.org"}){if(this.client_id=e,this.env=t.env||"prod",this.local_user_id=t.local_user_id,this.baseUrl=t.baseUrlWidget||"https://demo.blockpass.org",!this.client_id)throw new Error("missing client_id params");if(this.source=this.baseUrl+"/widget.html?clientId="+this.client_id+"&env="+this.env+"&refId="+this.local_user_id,this.iframe=document.createElement("iframe"),this.button=document.getElementById("blockpass-kyc-connect"),this.html=document.getElementsByTagName("html")[0],this.body=document.getElementsByTagName("body")[0],!this.button)throw new Error('Cannot find the button with id="blockpass-kyc-connect". Please add it in your html <body>');this.callbackKYCConnectSuccess=null,this.callbackKYCConnectCancel=null,this.callbackKYCConnectClose=null,this._initEventHandler()}startKYCConnect(){document.getElementById("blockpass-kyc-connect").addEventListener("click",this._onBtnClickHandler)}stopKYCConnect(){this.html.style.removeProperty("overflow"),this.body.style.removeProperty("overflow"),this.html.style.removeProperty("margin"),this.body.style.removeProperty("margin"),this.iframe.setAttribute("style","display:none"),this.iframe.setAttribute("src","#"),this.iframe.remove(),window.removeEventListener("message",this._onIframeMessageHandler),document.removeEventListener("keydown",this._onKeyDownHandler)}on(e,t){"KYCConnectSuccess"===e&&(this.callbackKYCConnectSuccess=t),"KYCConnectCancel"===e&&(this.callbackKYCConnectCancel=t),"KYCConnectClose"===e&&(this.callbackKYCConnectClose=t)}_appendIframe(){this.html.style.overflow="hidden",this.body.style.margin="0",this.iframe.setAttribute("src",this.source),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("frameborder","none"),this.iframe.setAttribute("border","0"),this.iframe.setAttribute("resize","none"),this.iframe.setAttribute("id","blockpass-iframe"),this.iframe.setAttribute("style","z-index: 99999999999;  width: 100%; height: 100%; overflow: hidden auto; visibility: visible; margin: 0px; padding: 0px; position: fixed; border-color: transparent; border-width: 0; border-style: none; left: 0px; top: 0px; -webkit-tap-highlight-color: transparent;"),document.body.appendChild(this.iframe)}_getEvents(){window.addEventListener("message",this._onIframeMessageHandler),document.addEventListener("keydown",this._onKeyDownHandler)}_initEventHandler(){this._onBtnClickHandler=(e=>{this._appendIframe(),this._getEvents()}),this._onKeyDownHandler=(e=>{("key"in(e=e||window.event)?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&(this.stopKYCConnect(),window.postMessage("KYCConnectCancel","*"))}),this._onIframeMessageHandler=(e=>{e.origin==this.baseUrl&&("KYCConnectSuccess"===e.data&&(setTimeout(()=>{this.stopKYCConnect(),"function"==typeof this.callbackKYCConnectClose&&this.callbackKYCConnectClose()},1e4),"function"==typeof this.callbackKYCConnectSuccess&&this.callbackKYCConnectSuccess()),"KYCConnectCancel"===e.data&&(this.stopKYCConnect(),"function"==typeof this.callbackKYCConnectCancel&&this.callbackKYCConnectCancel()),"KYCConnectClose"===e.data&&(this.stopKYCConnect(),"function"==typeof this.callbackKYCConnectClose&&this.callbackKYCConnectClose()))})}}window.BlockpassKYCConnect=BlockpassKYCConnect;